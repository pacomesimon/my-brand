version: 2.1

workflows:
  on_commit:
    jobs:
      - createREADME

jobs:
  createREADME:
    docker:
      - image: cimg/node:14.13.0
    steps:
      - checkout
      - run:
          name: Install dependencies
          command: cd ./server && npm install
      - run:
          name: Build and Test README.md
          command: cd ./server && "node_modules/.bin/istanbul-badges-readme"
      - run:
          name: Put a README.md copy in Artifacts
          command: cat ./server/README.md > /tmp/README.md;
      - store_artifacts:
          path: /tmp/README.md
          destination: README.md